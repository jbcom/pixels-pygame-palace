entrypoint = "client/index.html"
onBoot = ["bash", "-lc", "./src/scripts/bootstrap_env.sh"]
run = ["bash", "-lc", "source .venv/bin/activate && npm run dev"]
modules = ["nodejs-24", "web", "python-3.11", "python3"]
hidden = [
  ".config",
  ".git",
  "node_modules",
  "dist",
  ".venv",
  "backend/__pycache__",
]

[nix]
channel = "stable-25_05"
packages = ["freetype", "iana-etc", "lcms2", "libimagequant", "libjpeg", "libtiff", "libwebp", "libxcrypt", "openjpeg", "tcl", "tk", "zlib"]

[env]
FLASK_ENV = "development"
FLASK_SECRET_KEY = "dev-secret-change-me"
NODE_ENV = "development"
PIP_USER = "0"

[deployment]
deploymentTarget = "autoscale"
build = ["bash", "-lc", "source .venv/bin/activate && npm run build"]
run = ["bash", "-lc", "source .venv/bin/activate && npm run start"]

[[ports]]
localPort = 5173
externalPort = 80

[[ports]]
localPort = 5000
externalPort = 3000

[[ports]]
localPort = 5001
externalPort = 3001
